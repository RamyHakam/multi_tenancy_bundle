<?phpnamespace Hakam\MultiTenancyBundle\Command;use Exception;use Hakam\MultiTenancyBundle\Config\TenantConnectionConfigDTO;use Hakam\MultiTenancyBundle\Enum\DatabaseStatusEnum;use Hakam\MultiTenancyBundle\Exception\MultiTenancyException;use Hakam\MultiTenancyBundle\Port\TenantConnectionManagerInterface;use Hakam\MultiTenancyBundle\Port\TenantDatabaseManagerInterface;use Hakam\MultiTenancyBundle\ValueObject\TenantDatabaseIdentifier;use Symfony\Component\Console\Attribute\AsCommand;use Symfony\Component\Console\Command\Command;use Symfony\Component\Console\Input\InputArgument;use Symfony\Component\Console\Input\InputInterface;use Symfony\Component\Console\Output\OutputInterface;#[AsCommand(    name: 'tenant:database:create',    description: 'Proxy to create a new tenant database.',)]final class CreateDatabaseCommand extends Command{    use CommandTrait;    public function __construct(        private readonly TenantDatabaseManagerInterface   $tenantDatabaseManager,        private readonly TenantConnectionManagerInterface $tenantConnectionManager)    {        parent::__construct();    }    protected function configure(): void    {        $this            ->setDescription('Create  new databases for a tenant')            ->addArgument('dbId', InputArgument::REQUIRED, 'Database Identifier')            ->setAliases(['t:d:c'])            ->setHelp('This command allows you to create the  new database for a tenant which is added to the main database config entity');    }    protected function execute(InputInterface $input, OutputInterface $output): int    {        try {            $dbConfigToCreate = $this->tenantConnectionManager->getTenantConnectionConfig(TenantDatabaseIdentifier::create($input->getArgument('dbId')));            if ($dbConfigToCreate == null || $dbConfigToCreate->dbStatus !== DatabaseStatusEnum::DATABASE_NOT_CREATED) {                $output->writeln('No new databases to create or the database is already created');                return 0;            }            $databaseCreated = $this->createDatabase($dbConfigToCreate, $output);            if (!$databaseCreated) {                throw new MultiTenancyException(sprintf('Failed to create database %s', $dbConfigToCreate->dbname));            }            $output->writeln(sprintf('Database %s created successfully', $dbConfigToCreate->dbname));            $this->tenantConnectionManager->updateTenantDatabaseStatus($dbConfigToCreate->identifier, DatabaseStatusEnum::DATABASE_CREATED);            $output->writeln('The new Database created successfully');            return 0;        } catch (Exception $e) {            $output->writeln($e->getMessage());            return 1;        }    }    private function createDatabase(TenantConnectionConfigDTO $dbConfiguration, OutputInterface $output): bool    {        return $this->tenantDatabaseManager->createTenantDatabase($dbConfiguration);    }}