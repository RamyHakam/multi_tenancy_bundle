"use strict";(globalThis.webpackChunkmulti_tenancy_bundle_docs=globalThis.webpackChunkmulti_tenancy_bundle_docs||[]).push([[22],{495(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"events/lifecycle-events","title":"Tenant Lifecycle Events","description":"Hook into tenant lifecycle operations with events for billing, monitoring, and external integrations","source":"@site/docs/events/lifecycle-events.md","sourceDirName":"events","slug":"/events/lifecycle-events","permalink":"/multi_tenancy_bundle/events/lifecycle-events","draft":false,"unlisted":false,"editUrl":"https://github.com/RamyHakam/multi_tenancy_bundle/tree/master/docs-site/docs/events/lifecycle-events.md","tags":[],"version":"current","frontMatter":{"id":"lifecycle-events","title":"Tenant Lifecycle Events","sidebar\\\\_label":"Lifecycle Events","description":"Hook into tenant lifecycle operations with events for billing, monitoring, and external integrations"},"sidebar":"tutorialSidebar","previous":{"title":"Usage & Features","permalink":"/multi_tenancy_bundle/usage/"},"next":{"title":"Tenant CLI Commands Reference","permalink":"/multi_tenancy_bundle/cli/cli-commands"}}');var s=t(4848),a=t(8453);const r={id:"lifecycle-events",title:"Tenant Lifecycle Events",sidebar_label:"Lifecycle Events",description:"Hook into tenant lifecycle operations with events for billing, monitoring, and external integrations"},c="\ud83c\udfaf Tenant Lifecycle Events",l={},d=[{value:"\ud83d\udccb Overview",id:"-overview",level:2},{value:"\ud83d\ude80 Available Events",id:"-available-events",level:2},{value:"TenantCreatedEvent",id:"tenantcreatedevent",level:3},{value:"TenantDeletedEvent",id:"tenantdeletedevent",level:3},{value:"TenantMigratedEvent",id:"tenantmigratedevent",level:3},{value:"TenantBootstrappedEvent",id:"tenantbootstrappedevent",level:3},{value:"TenantSwitchedEvent",id:"tenantswitchedevent",level:3},{value:"\ud83d\udca1 Complete Example: Multi-Purpose Subscriber",id:"-complete-example-multi-purpose-subscriber",level:2},{value:"\ud83d\udcca Event Execution Order",id:"-event-execution-order",level:2},{value:"\u26a1 Performance Considerations",id:"-performance-considerations",level:2},{value:"\u2705 Registering Subscribers",id:"-registering-subscribers",level:2},{value:"\ud83d\udd04 Backward Compatibility",id:"-backward-compatibility",level:2}];function o(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"-tenant-lifecycle-events",children:"\ud83c\udfaf Tenant Lifecycle Events"})}),"\n",(0,s.jsx)(n.p,{children:"The Multi-Tenancy Bundle provides a comprehensive event system that fires during key tenant lifecycle operations. This enables extensibility and integration with external services without modifying the bundle's core code."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-overview",children:"\ud83d\udccb Overview"}),"\n",(0,s.jsxs)(n.p,{children:["All tenant events extend the ",(0,s.jsx)(n.code,{children:"AbstractTenantEvent"})," base class and provide:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Tenant Identifier"}),": The unique identifier of the affected tenant"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Tenant Configuration"}),": The ",(0,s.jsx)(n.code,{children:"TenantConnectionConfigDTO"})," when available"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Timestamp"}),": When the event occurred (",(0,s.jsx)(n.code,{children:"DateTimeImmutable"}),")"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-available-events",children:"\ud83d\ude80 Available Events"}),"\n",(0,s.jsx)(n.h3,{id:"tenantcreatedevent",children:"TenantCreatedEvent"}),"\n",(0,s.jsx)(n.p,{children:"Dispatched when a new tenant database is created."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Fired from"}),": ",(0,s.jsx)(n.code,{children:"CreateDatabaseCommand"})," after successful database creation"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Properties"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"getTenantIdentifier()"}),": The tenant's unique identifier"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"getTenantConfig()"}),": The tenant connection configuration DTO"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"getDatabaseName()"}),": Name of the created database"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"getOccurredAt()"}),": Timestamp of the event"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Trigger billing/subscription setup"}),"\n",(0,s.jsx)(n.li,{children:"Send welcome notifications"}),"\n",(0,s.jsx)(n.li,{children:"Initialize external services for the tenant"}),"\n",(0,s.jsx)(n.li,{children:"Log tenant creation for auditing"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"use Hakam\\MultiTenancyBundle\\Event\\TenantCreatedEvent;\nuse Symfony\\Component\\EventDispatcher\\EventSubscriberInterface;\n\nclass TenantCreatedSubscriber implements EventSubscriberInterface\n{\n    public static function getSubscribedEvents(): array\n    {\n        return [TenantCreatedEvent::class => 'onTenantCreated'];\n    }\n\n    public function onTenantCreated(TenantCreatedEvent $event): void\n    {\n        $tenantId = $event->getTenantIdentifier();\n        $dbName = $event->getDatabaseName();\n        \n        // Initialize billing for the new tenant\n        $this->billingService->createSubscription($tenantId);\n        \n        // Send welcome email\n        $this->mailer->sendWelcomeEmail($tenantId);\n    }\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"tenantdeletedevent",children:"TenantDeletedEvent"}),"\n",(0,s.jsx)(n.p,{children:"Dispatched when a tenant database is dropped/deleted."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Fired from"}),": ",(0,s.jsx)(n.code,{children:"DbService::dropDatabase()"})," after successful database deletion"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Properties"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"getTenantIdentifier()"}),": The tenant's unique identifier"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"getDatabaseName()"}),": Name of the deleted database"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"getOccurredAt()"}),": Timestamp of the event"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Clean up external resources"}),"\n",(0,s.jsx)(n.li,{children:"Cancel billing/subscriptions"}),"\n",(0,s.jsx)(n.li,{children:"Archive tenant data"}),"\n",(0,s.jsx)(n.li,{children:"Send deletion notifications"}),"\n",(0,s.jsx)(n.li,{children:"Update monitoring/logging systems"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"use Hakam\\MultiTenancyBundle\\Event\\TenantDeletedEvent;\n\nclass TenantDeletedSubscriber implements EventSubscriberInterface\n{\n    public static function getSubscribedEvents(): array\n    {\n        return [TenantDeletedEvent::class => 'onTenantDeleted'];\n    }\n\n    public function onTenantDeleted(TenantDeletedEvent $event): void\n    {\n        $tenantId = $event->getTenantIdentifier();\n        \n        // Cancel subscription\n        $this->billingService->cancelSubscription($tenantId);\n        \n        // Clean up external storage\n        $this->storageService->deleteTenantFiles($tenantId);\n    }\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"tenantmigratedevent",children:"TenantMigratedEvent"}),"\n",(0,s.jsx)(n.p,{children:"Dispatched when migrations have been executed on a tenant database."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Fired from"}),": ",(0,s.jsx)(n.code,{children:"MigrateCommand"})," after successful migration execution"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Properties"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"getTenantIdentifier()"}),": The tenant's unique identifier"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"getTenantConfig()"}),": The tenant connection configuration DTO"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"getMigrationType()"}),": Either ",(0,s.jsx)(n.code,{children:"'init'"})," or ",(0,s.jsx)(n.code,{children:"'update'"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"isInitialMigration()"}),": Returns ",(0,s.jsx)(n.code,{children:"true"})," if this is the first migration"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"isUpdateMigration()"}),": Returns ",(0,s.jsx)(n.code,{children:"true"})," if this is an update migration"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"getToVersion()"}),": Target migration version (if specified)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"getOccurredAt()"}),": Timestamp of the event"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Constants"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"TenantMigratedEvent::TYPE_INIT"})," = ",(0,s.jsx)(n.code,{children:"'init'"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"TenantMigratedEvent::TYPE_UPDATE"})," = ",(0,s.jsx)(n.code,{children:"'update'"})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Log migration history"}),"\n",(0,s.jsx)(n.li,{children:"Trigger post-migration tasks (cache warming, etc.)"}),"\n",(0,s.jsx)(n.li,{children:"Notify administrators of schema changes"}),"\n",(0,s.jsx)(n.li,{children:"Update tenant status in external systems"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"use Hakam\\MultiTenancyBundle\\Event\\TenantMigratedEvent;\n\nclass TenantMigratedSubscriber implements EventSubscriberInterface\n{\n    public static function getSubscribedEvents(): array\n    {\n        return [TenantMigratedEvent::class => 'onTenantMigrated'];\n    }\n\n    public function onTenantMigrated(TenantMigratedEvent $event): void\n    {\n        if ($event->isInitialMigration()) {\n            $this->logger->info('Tenant database initialized', [\n                'tenant' => $event->getTenantIdentifier(),\n                'version' => $event->getToVersion(),\n            ]);\n        }\n        \n        // Clear cached schema information\n        $this->cacheService->clearTenantSchemaCache($event->getTenantIdentifier());\n    }\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"tenantbootstrappedevent",children:"TenantBootstrappedEvent"}),"\n",(0,s.jsx)(n.p,{children:"Dispatched when a tenant database has been bootstrapped with initial fixture data."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Fired from"}),": ",(0,s.jsx)(n.code,{children:"LoadTenantFixtureCommand"})," after successful fixture loading"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Properties"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"getTenantIdentifier()"}),": The tenant's unique identifier"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"getTenantConfig()"}),": The tenant connection configuration DTO (may be null)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"getLoadedFixtures()"}),": Array of loaded fixture class names"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"getOccurredAt()"}),": Timestamp of the event"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Notify tenant that environment is ready"}),"\n",(0,s.jsx)(n.li,{children:"Trigger post-setup tasks"}),"\n",(0,s.jsx)(n.li,{children:"Initialize default configurations"}),"\n",(0,s.jsx)(n.li,{children:"Send onboarding emails"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"use Hakam\\MultiTenancyBundle\\Event\\TenantBootstrappedEvent;\n\nclass TenantBootstrappedSubscriber implements EventSubscriberInterface\n{\n    public static function getSubscribedEvents(): array\n    {\n        return [TenantBootstrappedEvent::class => 'onTenantBootstrapped'];\n    }\n\n    public function onTenantBootstrapped(TenantBootstrappedEvent $event): void\n    {\n        $tenantId = $event->getTenantIdentifier();\n        $fixtures = $event->getLoadedFixtures();\n        \n        $this->logger->info('Tenant environment ready', [\n            'tenant' => $tenantId,\n            'fixtures_loaded' => count($fixtures),\n        ]);\n        \n        // Send \"Your account is ready\" notification\n        $this->notificationService->sendTenantReadyNotification($tenantId);\n    }\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"tenantswitchedevent",children:"TenantSwitchedEvent"}),"\n",(0,s.jsx)(n.p,{children:"Dispatched when the active tenant database connection is switched."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Fired from"}),": ",(0,s.jsx)(n.code,{children:"DbSwitchEventListener"})," after successful connection switch"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Properties"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"getTenantIdentifier()"}),": The new tenant's identifier"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"getTenantConfig()"}),": The new tenant's connection configuration DTO"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"getPreviousTenantIdentifier()"}),": Previous tenant identifier (or null)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"getPreviousDatabaseName()"}),": Previous database name (or null)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"hadPreviousTenant()"}),": Returns ",(0,s.jsx)(n.code,{children:"true"})," if there was a previous tenant"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"getOccurredAt()"}),": Timestamp of the event"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Track tenant access for analytics"}),"\n",(0,s.jsx)(n.li,{children:"Update request context"}),"\n",(0,s.jsx)(n.li,{children:"Clear tenant-specific caches"}),"\n",(0,s.jsx)(n.li,{children:"Log tenant access for auditing/security"}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{title:"Built-in Listener",type:"tip",children:(0,s.jsxs)(n.p,{children:["The bundle's ",(0,s.jsx)(n.code,{children:"TenantContext"})," service already listens to this event and tracks the current tenant identity. When ",(0,s.jsx)(n.a,{href:"/cache/cache-isolation",children:"Cache Isolation"})," is enabled, cache keys are automatically scoped based on this context."]})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"use Hakam\\MultiTenancyBundle\\Event\\TenantSwitchedEvent;\n\nclass TenantSwitchedSubscriber implements EventSubscriberInterface\n{\n    public static function getSubscribedEvents(): array\n    {\n        return [TenantSwitchedEvent::class => 'onTenantSwitched'];\n    }\n\n    public function onTenantSwitched(TenantSwitchedEvent $event): void\n    {\n        // Log tenant access\n        $this->analyticsService->trackTenantAccess($event->getTenantIdentifier());\n        \n        // Clear previous tenant's cache if switching\n        if ($event->hadPreviousTenant()) {\n            $this->cacheService->clearTenantCache($event->getPreviousTenantIdentifier());\n        }\n    }\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-complete-example-multi-purpose-subscriber",children:"\ud83d\udca1 Complete Example: Multi-Purpose Subscriber"}),"\n",(0,s.jsx)(n.p,{children:"Here's a complete example of a subscriber that handles all tenant lifecycle events:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"<?php\n\nnamespace App\\EventSubscriber;\n\nuse Hakam\\MultiTenancyBundle\\Event\\AbstractTenantEvent;\nuse Hakam\\MultiTenancyBundle\\Event\\TenantBootstrappedEvent;\nuse Hakam\\MultiTenancyBundle\\Event\\TenantCreatedEvent;\nuse Hakam\\MultiTenancyBundle\\Event\\TenantDeletedEvent;\nuse Hakam\\MultiTenancyBundle\\Event\\TenantMigratedEvent;\nuse Hakam\\MultiTenancyBundle\\Event\\TenantSwitchedEvent;\nuse Psr\\Log\\LoggerInterface;\nuse Symfony\\Component\\EventDispatcher\\EventSubscriberInterface;\n\nclass TenantLifecycleSubscriber implements EventSubscriberInterface\n{\n    public function __construct(\n        private readonly LoggerInterface $logger,\n        private readonly BillingServiceInterface $billingService,\n        private readonly NotificationServiceInterface $notificationService,\n    ) {\n    }\n\n    public static function getSubscribedEvents(): array\n    {\n        return [\n            TenantCreatedEvent::class => ['onTenantCreated', 0],\n            TenantDeletedEvent::class => ['onTenantDeleted', 0],\n            TenantMigratedEvent::class => ['onTenantMigrated', 0],\n            TenantBootstrappedEvent::class => ['onTenantBootstrapped', 0],\n            TenantSwitchedEvent::class => ['onTenantSwitched', -10],\n        ];\n    }\n\n    public function onTenantCreated(TenantCreatedEvent $event): void\n    {\n        $this->log('tenant.created', $event, [\n            'database_name' => $event->getDatabaseName(),\n        ]);\n\n        $this->billingService->createSubscription(\n            $event->getTenantIdentifier(),\n            $event->getTenantConfig()\n        );\n    }\n\n    public function onTenantDeleted(TenantDeletedEvent $event): void\n    {\n        $this->log('tenant.deleted', $event, [\n            'database_name' => $event->getDatabaseName(),\n        ]);\n\n        $this->billingService->cancelSubscription($event->getTenantIdentifier());\n    }\n\n    public function onTenantMigrated(TenantMigratedEvent $event): void\n    {\n        $this->log('tenant.migrated', $event, [\n            'migration_type' => $event->getMigrationType(),\n            'version' => $event->getToVersion(),\n        ]);\n\n        if ($event->isInitialMigration()) {\n            $this->notificationService->notifyTenantReady($event->getTenantIdentifier());\n        }\n    }\n\n    public function onTenantBootstrapped(TenantBootstrappedEvent $event): void\n    {\n        $this->log('tenant.bootstrapped', $event, [\n            'fixtures_count' => count($event->getLoadedFixtures()),\n        ]);\n    }\n\n    public function onTenantSwitched(TenantSwitchedEvent $event): void\n    {\n        if ($event->hadPreviousTenant()) {\n            $this->log('tenant.switched', $event, [\n                'from_tenant' => $event->getPreviousTenantIdentifier(),\n            ]);\n        }\n    }\n\n    private function log(string $eventName, AbstractTenantEvent $event, array $extra = []): void\n    {\n        $this->logger->info(\"Tenant lifecycle: {$eventName}\", array_merge([\n            'tenant_identifier' => $event->getTenantIdentifier(),\n            'occurred_at' => $event->getOccurredAt()->format('c'),\n        ], $extra));\n    }\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-event-execution-order",children:"\ud83d\udcca Event Execution Order"}),"\n",(0,s.jsx)(n.p,{children:"The events fire in the following logical order during tenant setup:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"TenantCreatedEvent"})," \u2014 Database created"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"TenantMigratedEvent"})," (type: init) \u2014 Initial schema applied"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"TenantBootstrappedEvent"})," \u2014 Fixtures loaded"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"TenantSwitchedEvent"})," \u2014 Every time the connection switches"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"For updates:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"TenantMigratedEvent"})," (type: update) \u2014 Schema updated"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"For teardown:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"TenantDeletedEvent"})," \u2014 Database dropped"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-performance-considerations",children:"\u26a1 Performance Considerations"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Events are dispatched ",(0,s.jsx)(n.strong,{children:"synchronously"})," by default"]}),"\n",(0,s.jsx)(n.li,{children:"Keep event listeners lightweight to avoid impacting command execution"}),"\n",(0,s.jsx)(n.li,{children:"For heavy processing, consider dispatching async messages from your listeners"}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"TenantSwitchedEvent"})," fires on every context switch \u2014 use it judiciously"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-registering-subscribers",children:"\u2705 Registering Subscribers"}),"\n",(0,s.jsx)(n.p,{children:"Subscribers are automatically registered when using Symfony's autoconfigure:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# config/services.yaml\nservices:\n    _defaults:\n        autoconfigure: true\n    \n    App\\EventSubscriber\\:\n        resource: '../src/EventSubscriber/'\n"})}),"\n",(0,s.jsx)(n.p,{children:"Or explicitly:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"services:\n    App\\EventSubscriber\\TenantLifecycleSubscriber:\n        tags: ['kernel.event_subscriber']\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-backward-compatibility",children:"\ud83d\udd04 Backward Compatibility"}),"\n",(0,s.jsx)(n.p,{children:"This event system is fully backward compatible. Existing applications that don't subscribe to these events will continue to work without any changes."})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},8453(e,n,t){t.d(n,{R:()=>r,x:()=>c});var i=t(6540);const s={},a=i.createContext(s);function r(e){const n=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);